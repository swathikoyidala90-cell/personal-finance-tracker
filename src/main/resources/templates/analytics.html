<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Analytics | Finance Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #0e1117;
            color: #eaeaea;
            font-family: 'Segoe UI', Roboto, sans-serif;
        }
        .chart-card {
            background: linear-gradient(145deg, #1a1f29, #11151c);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
            margin: 20px auto;
            max-width: 900px;
        }
        .btn-outline-warning {
            border-color: #d4af37;
            color: #d4af37;
            transition: 0.3s;
        }
        .btn-outline-warning:hover {
            background-color: #d4af37;
            color: #0e1117;
        }
    </style>
</head>
<body>
<div class="container text-center mt-5">
    <h2>üìà Financial Analytics</h2>
    <p class="text-muted">Overview of your income and expenses</p>

    <div class="chart-card">
        <canvas id="expensePieChart" height="200"></canvas>
    </div>

    <div class="chart-card">
        <canvas id="incomeExpenseLineChart" height="200"></canvas>
    </div>

    <!-- Back to Dashboard Button -->
    <div class="text-center mt-4">
        <a href="/dashboard" class="btn btn-outline-warning px-4 py-2 rounded-3">
            ‚Üê Back to Dashboard
        </a>
    </div>
</div>

<script th:inline="javascript">
    const expenseByCategory = [[${expenseByCategory}]];
    const incomeByDate = [[${incomeByDate}]];
    const expenseByDate = [[${expenseByDate}]];

    // Pie Chart
    const pieLabels = Object.keys(expenseByCategory);
    const pieData = Object.values(expenseByCategory);
    new Chart(document.getElementById("expensePieChart"), {
        type: 'pie',
        data: {
            labels: pieLabels,
            datasets: [{
                data: pieData,
                backgroundColor: ['#d4af37', '#a87d2d', '#856d3c', '#f5c542', '#cbb26a']
            }]
        }
    });

    // Line Chart
    const lineLabels = Object.keys(incomeByDate);
    new Chart(document.getElementById("incomeExpenseLineChart"), {
        type: 'line',
        data: {
            labels: lineLabels,
            datasets: [
                {
                    label: "Income",
                    data: Object.values(incomeByDate),
                    borderColor: "#4caf50",
                    tension: 0.3
                },
                {
                    label: "Expenses",
                    data: Object.values(expenseByDate),
                    borderColor: "#f44336",
                    tension: 0.3
                }
            ]
        }
    });
</script>
</body>
</html>